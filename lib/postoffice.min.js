/*! postoffice 10-07-2014 */
var nodemailer=require("nodemailer"),liquid=require("liquid-node"),engine=new liquid.Engine,fs=require("fs"),path=require("path"),smtpTransport,config={smtp:{host:"mailtrap.io",port:2525,auth:{user:"177934039fdb1379c",pass:"3e38be9ab971f5"}},templates:{path:path.dirname(require.main.filename)+"/../data/templates"}};module.exports={configure:function(a){a(config)},init:function(){smtpTransport=nodemailer.createTransport("SMTP",config.smtp)},send:function(a){smtpTransport.sendMail(a,function(a,b){console.log(a?a:"Message sent: "+b.message)})},sendTemplate:function(a,b,c){var d={};console.log(config.templates.path+"/"+a+".html.liquid"),fs.readFile(config.templates.path+"/"+a+".html.liquid",function(e,f){if(e)throw e;engine.parseAndRender(f,b).then(function(e){d.html=e,fs.readFile(config.templates.path+"/"+a+".text.liquid",function(a,e){if(a)throw a;engine.parseAndRender(e,b).then(function(a){d.text=a,c.html=d.html,c.text=d.text,smtpTransport.sendMail(c,function(a,b){console.log(a?a:"Message sent: "+b.message)})})})})})},close:function(){smtpTransport.close()}};